"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useL7ComponentEvent = void 0;
var _ahooks = require("ahooks");
var _react = require("react");
/**
 * 为 Control 绑定对应事件的回调，并且在回调函数发生更新时重新绑定
 * @param control
 * @param props
 */
const useL7ComponentEvent = (control, props) => {
  const eventNameList = (0, _react.useMemo)(() => Object.keys(props), [props]);
  (0, _react.useEffect)(() => {
    if (control) {
      eventNameList.forEach(eventName => {
        const callback = props[eventName];
        if (callback) {
          control.on(eventName, callback);
        }
      });
    }
    return () => {
      if (control) {
        eventNameList.forEach(eventName => {
          const callback = props[eventName];
          if (callback) {
            control.off(eventName, callback);
          }
        });
      }
    };
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [control, ...Object.values(props)]);
  (0, _ahooks.useUnmount)(() => {
    if (!control) {
      return;
    }
    eventNameList.forEach(eventName => {
      const callback = props[eventName];
      if (callback) {
        control.off(eventName, callback);
      }
    });
  });
};
exports.useL7ComponentEvent = useL7ComponentEvent;