import _regeneratorRuntime from "@babel/runtime/helpers/esm/regeneratorRuntime";
import _asyncToGenerator from "@babel/runtime/helpers/esm/asyncToGenerator";
import { urlToMarkerId } from "./util";
export function setMapContext(props, scene) {
  //初始化Image
  if (props.markers) {
    var icons = new Set(props.markers.filter(function (item) {
      return item.iconPath !== undefined;
    }).map(function (item) {
      return item.iconPath;
    }));
    return Promise.all(Array.from(icons.values()).map( /*#__PURE__*/function () {
      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(url) {
        var id;
        return _regeneratorRuntime().wrap(function _callee$(_context) {
          while (1) switch (_context.prev = _context.next) {
            case 0:
              id = urlToMarkerId(url);
              if (!scene.hasImage(id)) {
                _context.next = 3;
                break;
              }
              return _context.abrupt("return");
            case 3:
              _context.next = 5;
              return scene.addImage(id, url);
            case 5:
              return _context.abrupt("return", _context.sent);
            case 6:
            case "end":
              return _context.stop();
          }
        }, _callee);
      }));
      return function (_x) {
        return _ref.apply(this, arguments);
      };
    }()));
  }
}