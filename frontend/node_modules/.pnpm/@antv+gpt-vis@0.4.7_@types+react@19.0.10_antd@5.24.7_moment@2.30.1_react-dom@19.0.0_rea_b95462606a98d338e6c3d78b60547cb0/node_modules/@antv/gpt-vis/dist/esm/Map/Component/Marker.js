import _slicedToArray from "@babel/runtime/helpers/esm/slicedToArray";
import { useScene } from '@antv/larkmap';
import { useEffect, useState } from 'react';
import { setMapContext, setMarkers } from "../../utils/map";
// 渲染标记点
export default (function (props) {
  var scene = useScene();
  var _useState = useState([]),
    _useState2 = _slicedToArray(_useState, 2),
    layers = _useState2[0],
    setLayers = _useState2[1];
  var removeLayers = function removeLayers() {
    layers.forEach(function (item) {
      scene.removeLayer(item);
    });
  };
  useEffect(function () {
    var _setMapContext;
    if (!props.markers) return;
    // 异步调用
    (_setMapContext = setMapContext(props, scene)) === null || _setMapContext === void 0 || _setMapContext.then(function () {
      // 初始化资源
      var markerLayer = setMarkers(props.markers || []);
      removeLayers();
      markerLayer.forEach(function (item) {
        scene.addLayer(item);
      });
      setLayers(markerLayer);
    });
    return function () {
      removeLayers();
    };
  }, [props.markers]);
  return null;
});